<html>
<head>
 <title>Allen Scorecard Creator</title>
 <script type="text/javascript">
<!--
function setSelection(sel, value) {
 for (i=0; i < sel.options.length; i++) {
  if (sel.options[i].value == value) {
    sel.selectedIndex = i;
    return;
  }
 }
}

function setStartDate() {
 setSelection(document.getElementById("month"), {{ month }});
 setSelection(document.getElementById("day"), {{ day }});
 setSelection(document.getElementById("year"), {{ year }});
}

function dateChange(form) {
 // Clear the game drop-down
 gameSel = form.gameID;
 gameSel.options.length = 0;
 // Request the list of games for the new date
 var url = "getgames?";
 url += "month=" + form.month.value;
 url += "&day=" + form.day.value;
 url += "&year=" + form.year.value;

 var req = new XMLHttpRequest();
 req.open("GET",url,false);
 req.send("");
 games = req.responseText;

 gameList = eval("(" + games + ")");
 for (i = 0; i < gameList.length; i++) {
  gameSel.options.add(new Option(gameList[i].away + " @ " + gameList[i].home, gameList[i].url));
 }
}
 
function updateScorecard(form) {
 var url = "scorecard?";
 url += "month=" + form.month.value;
 url += "&day=" + form.day.value;
 url += "&year=" + form.year.value;
 url += "&gameID=" + form.gameID.value;

 document.getElementById("scorecard").src = url;
}

//-->
 </script>
</head>
<body onLoad="setStartDate()">

<form action="/choosegame" method="get">
 <select id="month" name="month" onchange="dateChange(this.form)">
  <option value="01">1</option>
  <option value="02">2</option>
  <option value="03">3</option>
  <option value="04">4</option>
  <option value="05">5</option>
  <option value="06">6</option>
  <option value="07">7</option>
  <option value="08">8</option>
  <option value="09">9</option>
  <option value="10">10</option>
  <option value="11">11</option>
  <option value="12">12</option>
 </select>
 <select id="day" name="day" onchange="dateChange(this.form)">
  <option value="01">1</option>
  <option value="02">2</option>
  <option value="03">3</option>
  <option value="04">4</option>
  <option value="05">5</option>
  <option value="06">6</option>
  <option value="07">7</option>
  <option value="08">8</option>
  <option value="09">9</option>
  <option value="10">10</option>
  <option value="11">11</option>
  <option value="12">12</option>
  <option value="13">13</option>
  <option value="14">14</option>
  <option value="15">15</option>
  <option value="16">16</option>
  <option value="17">17</option>
  <option value="18">18</option>
  <option value="19">19</option>
  <option value="20">20</option>
  <option value="21">21</option>
  <option value="22">22</option>
  <option value="23">23</option>
  <option value="24">24</option>
  <option value="25">25</option>
  <option value="26">26</option>
  <option value="27">27</option>
  <option value="28">28</option>
  <option value="29">29</option>
  <option value="30">30</option>
  <option value="31">31</option>
 </select>
 <select id="year" name="year" onchange="dateChange(this.form)">
  <option value="2008">2008</option>
  <option value="2009">2009</option>
  <option value="2010">2010</option>
 </select>
 <select id="gameID" name="gameID">
   {% for game in games %}
    <option value="{{ game.url }}">{{ game.away }} @ {{ game.home }}</option>
   {% endfor %}
 </select>
 <input type="button" value="View Scorecard" onclick="updateScorecard(this.form)">
</form>

<hr>
<embed id="scorecard"/>
</body>
</html>
